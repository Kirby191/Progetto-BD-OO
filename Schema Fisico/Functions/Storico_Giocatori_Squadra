CREATE OR REPLACE FUNCTION Storico_Giocatori(SquadraInEsame TEXT)
RETURNS TABLE(SSN_Giocatore ssn_valido)
AS $$
	
		BEGIN
		
			IF( NOT EXISTS ( SELECT *
					 FROM Squadra
					 WHERE Nome_Squadra = SquadraInEsame)) THEN 
				
				RAISE EXCEPTION 'La squadra indicata non esiste';
				
			END IF;

			RETURN QUERY SELECT DISTINCT SSN FROM Militanza WHERE NomeSquadra = SquadraInEsame;		
		
		END;
$$ Language plpgsql;
