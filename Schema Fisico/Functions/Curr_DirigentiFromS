CREATE OR REPLACE FUNCTION Curr_DirigentiFromS(Squadra SQUADRA.Nome_Squadra%TYPE)
RETURNS TABLE(SSN_Dirigente DIRIGENTE.SSN%TYPE)
AS $$
	DECLARE
	Cursor Dirigenti IS(
	SELECT SSN_Dirigente
	FROM Dirige
	WHERE NomeSquadra = Squadra);
	
	Curr_Dirigente DIRIGENTE.SSN%TYPE;
	final_string TEXT;
	
		BEGIN
			OPEN Dirigenti;
	
			LOOP
	
				FETCH Dirigenti INTO Curr_Dirigente;		
				EXIT WHEN Dirigenti%NotFound;
				
				final_string := final_string || Curr_Dirigente || ' ';
				
			END LOOP;
			
			CLOSE Dirigenti;
			
			RETURN QUERY SELECT * FROM string_to_table(final_string, ' ');
			
		END;
$$ Language plpgsql
