//controllo che la data fine di un allenatore in inserimento sia null
CREATE OR REPLACE FUNCTION CheckFineANotNullBeforeInsert()
RETURNS TRIGGER AS $$
BEGIN
	--ricerca dell'allenatore e controllo se ha finito la sua carriera da allenatore
	IF ((SELECT FineA
	    FROM Allenatore
	    WHERE SSN = NEW.SSN_Allenatore) IS NOT NULL) THEN 
		RAISE EXCEPTION 'L''allenatore inserito ha terminato la sua carriera, non pu√≤ allenare la squadra';
	END IF;
	RETURN NEW;
END;
$$ Language plpgsql;

CREATE OR REPLACE TRIGGER check_fineA_notnull_bef_insert
BEFORE INSERT ON Squadra
FOR EACH ROW
EXECUTE FUNCTION CheckFineANotNullBeforeInsert();